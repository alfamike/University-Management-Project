<%- include('base', { title: 'Student Detail' }) %>

<div class="student-detail-container">
    <!-- Header Section -->
    <div class="student-header">
        <h1 class="page-title"><%= student.first_name %> <%= student.last_name %></h1>
        <p class="student-email"><%= student.email %></p>
    </div>

    <!-- Details Section -->
    <div class="student-details">
        <div class="details-card">
            <h2 class="details-title">Student Information
                <button id="edit-student-btn" class="btn">Edit</button>
                <button id="delete-student-btn" class="btn">Delete</button>
            </h2>
            <div class="details-content">
                <div class="detail-item">
                    <span class="detail-label">First Name:</span>
                    <span class="detail-value"><%= student.first_name %></span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Last Name:</span>
                    <span class="detail-value"><%= student.last_name %></span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Email:</span>
                    <span class="detail-value"><%= student.email %></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Related Courses Section -->
    <div class="related-courses">
        <h2 class="details-title">Enrolled Courses
            <button id="add-course-btn" class="btn">Add Course</button>
            <button id="delete-course-btn" class="btn">Remove Course</button>
            <button id="show-activities-course-btn" class="btn">Show Activities</button>
            <button id="manage-grade-btn" class="btn">Manage Grade</button>
        </h2>
        <% if (courses && courses.length > 0) { %>
        <table class="table">
            <thead>
            <tr>
                <th>Select</th>
                <th>Course Name</th>
                <th>Description</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Grade</th>
            </tr>
            </thead>
            <tbody>
            <% courses.forEach(function(course) { %>
            <tr>
                <td><label>
                    <input type="checkbox" class="course-checkbox" value="<%= course.id %>">
                </label></td>
                <td><%= course.name %></td>
                <td><%= course.description %></td>
                <td><%= course.start_date %></td>
                <td><%= course.end_date %></td>
                <td>
                    <% for (let grade of course_grades) { %>
                    <% if (grade.course_id === course.id) { %>
                    <%= grade.grade %>
                    <% } %>
                    <% } %>
                </td>
            </tr>
            <% }) %>
            </tbody>
        </table>
        <div class="cards">
            <% courses.forEach(function(course) { %>
            <div class="card">
                <h3><%= course.name %></h3>
                <p><%= course.description %></p>
                <p><strong>Start Date:</strong> <%= course.start_date %></p>
                <p><strong>End Date:</strong> <%= course.end_date %></p>
                <p><strong>Grade:</strong>
                    <% for (let grade of course_grades) { %>
                    <% if (grade.course_id === course.id) { %>
                    <%= grade.grade %>
                    <% } %>
                    <% } %>
                </p>
            </div>
            <% }) %>
        </div>
        <% } else { %>
        <p class="no-courses">This student is not enrolled in any courses.</p>
        <% } %>
    </div>
</div>

<!-- Pop-up for adding a course -->
<div id="add-course-popup" class="popup">
    <div class="popup-content">
        <span class="close-btn">&times;</span>
        <h3>Add Course to student</h3>
        <form id="add-course-form">
            <label for="course-title">Title:</label>
            <select id="course-title" name="course-title" class="filter-dropdown">
                <!-- Options for titles -->
            </select>
            <label for="course-name">Course:</label>
            <select id="course-name" name="course-name" class="filter-dropdown">
                <!-- Options for courses related to the selected title -->
            </select>
            <button type="submit" class="btn">Add</button>
        </form>
    </div>
</div>

<!--<script id="data" type="application/json">-->
<!--    {-->
<!--        "student": <%- "JSON.stringify(student)" %>,-->
<!--        "courses": <%- "JSON.stringify(courses)" %>,-->
<!--        "titles": <%- "JSON.stringify(titles)" %>,-->
<!--        "activities": <%- "JSON.stringify(activities)" %>,-->
<!--        "course_grades": <% "JSON.stringify(course_grades)" %>,-->
<!--        "activity_grades": <%- "JSON.stringify(activity_grades)" %>-->
<!--    }-->
<!--</script>-->

<% // Include extra CSS for this page %>
<%- include('partials/extra_css', { additionalCSS: '../public/css/student_record.css' }) %>

<% // Include extra JS for this page %>
<%- include('partials/extra_js', { additionalJS: '../public/js/student_record.js' }) %>